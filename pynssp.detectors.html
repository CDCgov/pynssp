<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
    <link href="_static/favicon/favicon.ico" rel="icon" type="image/x-icon">
    <link href="_static/favicon/favicon-16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="_static/favicon/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png">
    <link rel="apple-touch-icon" href="_static/favicon/apple-touch-icon.png" sizes="180x180" type="image/png">
    <link rel="android-chrome" href="_static/favicon/android-chrome-192x192.png" sizes="192x192" type="image/png">
    <link rel="android-chrome" href="_static/favicon/android-chrome-512x512.png" sizes="512x512" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pynssp.detectors package &mdash; pynssp 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="history.html" />
    <link rel="prev" title="pynssp.core package" href="pynssp.core.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pynssp
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="readme.html">About pynssp</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing pynssp</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hands-On Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="articles/intro.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/anomaly_detection.html">Anomaly Detection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pynssp</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pynssp.html">pynssp package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pynssp.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pynssp.core.html">pynssp.core package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">pynssp.detectors package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pynssp.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynssp.html#module-pynssp.data">pynssp.data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynssp.html#module-pynssp.pynssp">pynssp.pynssp module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynssp.html#module-pynssp.utils">pynssp.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pynssp.html#module-pynssp">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="disclaimer.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="codeofconduct.html">Creating a Culture of Innovation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pynssp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">pynssp</a></li>
          <li class="breadcrumb-item"><a href="pynssp.html">pynssp package</a></li>
      <li class="breadcrumb-item active">pynssp.detectors package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cdcgov/pynssp/blob/master/docs/pynssp.detectors.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pynssp-detectors-package">
<h1>pynssp.detectors package<a class="headerlink" href="#pynssp-detectors-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pynssp.detectors.ewma">
<span id="pynssp-detectors-ewma-module"></span><h2>pynssp.detectors.ewma module<a class="headerlink" href="#module-pynssp.detectors.ewma" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.ewma.alert_ewma">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.ewma.</span></span><span class="sig-name descname"><span class="pre">alert_ewma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/ewma.html#alert_ewma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.ewma.alert_ewma" title="Permalink to this definition"></a></dt>
<dd><p>Exponentially Weighted Moving Average (EWMA)</p>
<p>The EWMA compares a weighted average of the most recent visit counts
to a baseline expectation. For the weighted average to be tested, an exponential
weighting gives the most influence to the most recent observations.
This algorithm is appropriate for daily counts that do not have the
characteristic features modeled in the regression algorithm. It is more applicable
for Emergency Department data from certain hospital groups and for time series with
small counts (daily average below 10) because of the limited case definition or
chosen geographic region. An alert (red value) is signaled if the statistical test
(student”s t-test) applied to the test statistic yields a p-value less than 0.01.
If the p-value is greater than or equal to 0.01 and strictly less than 0.05, a warning
(yellow value) is signaled. Blue values are returned if an alert or warning does not
occur. Grey values represent instances where anomaly detection did not apply
(i.e., observations for which baseline data were unavailable).</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame containing time series data</p></li>
<li><p><strong>t</strong> – Name of the column of type Date containing the dates (Default value = “date”)</p></li>
<li><p><strong>y</strong> – Name of the column of type Numeric containing counts or percentages (Default value = “count”)</p></li>
<li><p><strong>B</strong> – Baseline parameter. The baseline length is the number of days used to
calculate rolling averages, standard deviations, and exponentially weighted
moving averages. Defaults to 28 days to match ESSENCE implementation.</p></li>
<li><p><strong>g</strong> – Guardband parameter. The guardband length is the number of days separating
the baseline from the current test date. Defaults to 2 days to match ESSENCE
implementation.</p></li>
<li><p><strong>w1</strong> – Smoothing coefficient for sensitivity to gradual events. Must be between
0 and 1 and is recommended to be between 0.3 and 0.5 to account for gradual
effects. Defaults to 0.4 to match ESSENCE implementation.</p></li>
<li><p><strong>w2</strong> – Smoothed coefficient for sensitivity to sudden events. Must be between
0 and 1 and is recommended to be above 0.7 to account for sudden events.
Defaults to 0.9 to match ESSENCE implementation and approximate the C2 algorithm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Original pandas data frame with detection results.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp.detectors.ewma</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-12-31&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">366</span><span class="p">)</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_ewma</span> <span class="o">=</span> <span class="n">alert_ewma</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_ewma</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.ewma.ewma_loop">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.ewma.</span></span><span class="sig-name descname"><span class="pre">ewma_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/ewma.html#ewma_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.ewma.ewma_loop" title="Permalink to this definition"></a></dt>
<dd><p>Loop for EWMA</p>
<p>Loop for EWMA and adjustment of outlying smoothed values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame</p></li>
<li><p><strong>t</strong> – Name of the column of type Date containing the dates</p></li>
<li><p><strong>y</strong> – Name of the column containing the response variable data</p></li>
<li><p><strong>mu</strong> – Numeric vector of baseline averages</p></li>
<li><p><strong>B</strong> – Baseline parameter. The baseline length is the number of days used to
calculate rolling averages, standard deviations, and exponentially weighted
moving averages. Defaults to 28 days to match NSSP-ESSENCE implementation.</p></li>
<li><p><strong>g</strong> – Guardband parameter. The guardband length is the number of days separating
the baseline from the current test date. Defaults to 2 days to match NSSP-ESSENCE
implementation.</p></li>
<li><p><strong>w1</strong> – Smoothing coefficient for sensitivity to gradual events. Must be between
0 and 1 and is recommended to be between 0.3 and 0.5 to account for gradual
effects. Defaults to 0.4 to match NSSP-ESSENCE implementation.</p></li>
<li><p><strong>w2</strong> – Smoothed coefficient for sensitivity to sudden events. Must be between
0 and 1 and is recommended to be above 0.7 to account for sudden events.
Defaults to 0.9 to match NSSP-ESSENCE implementation and approximate the C2 algorithm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas data frame with p-values and test statistics</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pynssp.detectors.farrington">
<span id="pynssp-detectors-farrington-module"></span><h2>pynssp.detectors.farrington module<a class="headerlink" href="#module-pynssp.detectors.farrington" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.farrington.alert_farrington">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.farrington.</span></span><span class="sig-name descname"><span class="pre">alert_farrington</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">27</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'original'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/farrington.html#alert_farrington"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.farrington.alert_farrington" title="Permalink to this definition"></a></dt>
<dd><p>Farrington Temporal Detector</p>
<p>The Farrington algorithm is intended for weekly time series of counts
spanning multiple years. Original Farrington Algorithm: Quasi-Poisson
generalized linear regression models are fit to baseline counts associated
with reference dates in the B previous years, including w weeks before
and after each reference date. The algorithm checks for convergence with a
time term and refits a model with only an intercept term in the scenario
the model does not converge. The inclusion of high baseline counts associated
with past outbreaks or public health events is known to result in alerting
thresholds that are too high and a reduction in sensitivity.
An empirically derived weighting function is used to calculate weights
from Anscombe residuals that assign low weight to baseline observations
with large residuals. A 2/3rds transformation is applied to account for
skewness common to time series with lower counts, after which expected
value and variance estimates are used to derive upper and lower bounds for
the prediction interval. The alert score is defined as the current observation
minus the forecast value divided by the upper prediction interval bound minus
the forecast value. If this score exceeds 1, an alert (red value) is raised
given that the number of counts in the last 4 days is above 5.
This algorithm requires that the number of years included in the baseline is 3
or higher. Blue values are returned if an alert does not occur.
Grey values represent instances where anomaly detection did not apply
(i.e., observations for which baseline data were unavailable).</p>
<p>Modified Farrington Algorithm: In 2012, Angela Noufaily developed a modified
implementation of the original Farrington algorithm that improved performance
by including more historical data in the baseline.
The modified algorithm includes all weeks from the beginning of the first
reference window to the last week proceeding a 27-week guardband period used
to separate the test week from the baseline.
A 10-level factor is used to account for seasonality throughout the baseline.
Additionally, the modified algorithm assumes a negative binomial distribution
on the weekly time series counts, where thresholds are computed as quantiles
of the negative binomial distribution with plug-in estimates for mu and phi.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas dataframe</p></li>
<li><p><strong>t</strong> – A column containing date values (Default value = “date”)</p></li>
<li><p><strong>y</strong> – A column containing time series counts (Default value = “count”)</p></li>
<li><p><strong>B</strong> – Number of years to include in baseline (default is 4)</p></li>
<li><p><strong>g</strong> – Number of guardband weeks to separate the test date
from the baseline (default is 27)</p></li>
<li><p><strong>w</strong> – Half the number of weeks included in reference window,
before and after each reference date (default is 3)</p></li>
<li><p><strong>p</strong> – Number of seasonal periods for each year in baseline</p></li>
<li><p><strong>method</strong> – A string of either “original” (default) or “modified”
to specify the version of the Farrington algorithm (original vs modified).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">get_scenario1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_org</span>  <span class="o">=</span> <span class="n">alert_farrington</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;cases&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_org</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">get_scenario1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_mod</span>  <span class="o">=</span> <span class="n">alert_farrington</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;cases&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;modified&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_mod</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example 3 (grouped data)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_simulated_ts</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_grp</span>  <span class="o">=</span> <span class="n">alert_farrington</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;cases&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_grp</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.farrington.farrington_modified">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.farrington.</span></span><span class="sig-name descname"><span class="pre">farrington_modified</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">27</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/farrington.html#farrington_modified"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.farrington.farrington_modified" title="Permalink to this definition"></a></dt>
<dd><p>Modified Farrington Algorithm</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas dataframe</p></li>
<li><p><strong>t</strong> – A column containing date values (Default value = “date”)</p></li>
<li><p><strong>y</strong> – A column containing time series counts (Default value = “count”)</p></li>
<li><p><strong>B</strong> – Number of years to include in baseline (default is 4)</p></li>
<li><p><strong>g</strong> – Number of guardband weeks to separate the test date
from the baseline (default is 27)</p></li>
<li><p><strong>w</strong> – Half the number of weeks included in reference window, before and
after each reference date (default is 3)</p></li>
<li><p><strong>p</strong> – Number of seasonal periods for each year in baseline</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas dataframe</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">get_scenario1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_mod</span>  <span class="o">=</span> <span class="n">farrington_modified</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;cases&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;modified&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_mod</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.farrington.farrington_original">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.farrington.</span></span><span class="sig-name descname"><span class="pre">farrington_original</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/farrington.html#farrington_original"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.farrington.farrington_original" title="Permalink to this definition"></a></dt>
<dd><p>Original Farrington Algorithm</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas dataframe</p></li>
<li><p><strong>t</strong> – A column containing date values (Default value = “date”)</p></li>
<li><p><strong>y</strong> – A column containing time series counts (Default value = “count”)</p></li>
<li><p><strong>B</strong> – Number of years to include in baseline (default is 4)</p></li>
<li><p><strong>w</strong> – Half the number of weeks included in reference window,
before and after each reference date (default is 3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas dataframe</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">get_scenario1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_farrington_org</span>  <span class="o">=</span> <span class="n">farrington_original</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;cases&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">farrington_org</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.farrington.seasonal_groups">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.farrington.</span></span><span class="sig-name descname"><span class="pre">seasonal_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">27</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_weeks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/farrington.html#seasonal_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.farrington.seasonal_groups" title="Permalink to this definition"></a></dt>
<dd><p>Return 10-level seasonal factor series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>B</strong> – Number of years to include in baseline (default is 4)</p></li>
<li><p><strong>g</strong> – Number of guardband weeks to separate the test week
from the baseline (default is 27)</p></li>
<li><p><strong>w</strong> – Half the number of weeks included in reference window,
before and after each reference date (default is 3)</p></li>
<li><p><strong>p</strong> – Number of seasonal periods for each year in baseline (default is 10)</p></li>
<li><p><strong>base_length</strong> – Total number of weeks included in baseline</p></li>
<li><p><strong>base_weeks</strong> – Indices of baseline weeks</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas Series</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pynssp.detectors.nbinom">
<span id="pynssp-detectors-nbinom-module"></span><h2>pynssp.detectors.nbinom module<a class="headerlink" href="#module-pynssp.detectors.nbinom" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.nbinom.alert_nbinom">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.nbinom.</span></span><span class="sig-name descname"><span class="pre">alert_nbinom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/nbinom.html#alert_nbinom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.nbinom.alert_nbinom" title="Permalink to this definition"></a></dt>
<dd><p>Negative binomial detection algorithm for weekly counts</p>
<p>The negative binomial regression algorithm fits a negative binomial regression
model with a time term and order 1 Fourier terms to a baseline period that
spans 2 or more years. Inclusion of Fourier terms in the model is intended
to account for seasonality common in multi-year weekly time series of counts.
Order 1 sine and cosine terms are included to account for annual seasonality
that is common to syndromes and diseases such as influenza, RSV, and norovirus.
Each baseline model is used to make weekly forecasts for all weeks following
the baseline period. One-sided upper 95% prediction interval bounds are
computed for each week in the prediction period. Alarms are signaled for
any week during for which weekly counts fall above the upper bound of
the prediction interval.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame containing time series data</p></li>
<li><p><strong>t</strong> – Name of the column of type Date containing the dates (Default value = “date”)</p></li>
<li><p><strong>y</strong> – Name of the column of type Numeric containing counts or percentages (Default value = “count”)</p></li>
<li><p><strong>baseline_end</strong> – date of the end of the baseline/training period (in date or string class)</p></li>
<li><p><strong>include_time</strong> – Indicate whether or not to include time term in regression model (default is True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Original pandas dataframe with model estimates, upper prediction interval bounds,
a binary alarm indicator field, and a binary indicator field of
whether or not a time term was included.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>   <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-01-05&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-02-05&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-01-05&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-02-05&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)),))</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_nbinom</span> <span class="o">=</span> <span class="n">alert_nbinom</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">baseline_end</span> <span class="o">=</span> <span class="s2">&quot;2020-03-01&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_nbinom</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.nbinom.nb_model">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.nbinom.</span></span><span class="sig-name descname"><span class="pre">nb_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/nbinom.html#nb_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.nbinom.nb_model" title="Permalink to this definition"></a></dt>
<dd><p>Negative binomial regression model for weekly counts</p>
<p>Negative binomial model helper function for monitoring weekly
count time series with seasonality</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame</p></li>
<li><p><strong>t</strong> – Name of the column of type Date containing the dates</p></li>
<li><p><strong>y</strong> – Name of the column of type Numeric containing counts</p></li>
<li><p><strong>baseline_end</strong> – Object of type Date defining the end of the baseline/training period</p></li>
<li><p><strong>include_time</strong> – Logical indicating whether or not to include time term in regression model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas data frame.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pynssp.detectors.regression">
<span id="pynssp-detectors-regression-module"></span><h2>pynssp.detectors.regression module<a class="headerlink" href="#module-pynssp.detectors.regression" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.regression.adaptive_regression">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.regression.</span></span><span class="sig-name descname"><span class="pre">adaptive_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/regression.html#adaptive_regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.regression.adaptive_regression" title="Permalink to this definition"></a></dt>
<dd><p>Adaptive Regression</p>
<p>Adaptive Regression helper function for Adaptive Multiple Regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame containing time series data</p></li>
<li><p><strong>t</strong> – Name of the column of type Date containing the dates</p></li>
<li><p><strong>y</strong> – Name of the column containing the response variable data</p></li>
<li><p><strong>B</strong> – Baseline parameter. The baseline length is the number of days to
which each liner model is fit.</p></li>
<li><p><strong>g</strong> – Guardband parameter. The guardband length is the number of days
separating the baseline from the current date in consideration for alerting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas data frame with p-values and test statistics</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.regression.alert_regression">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.regression.</span></span><span class="sig-name descname"><span class="pre">alert_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/regression.html#alert_regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.regression.alert_regression" title="Permalink to this definition"></a></dt>
<dd><p>Adaptive Multiple Regression</p>
<p>The adaptive multiple regression algorithm fits a linear model to a baseline
of counts or percentages of length B, and forecasts a predicted value g + 1
days later (guard-band). This value is compared to the current observed value
and divided by the standard error of prediction in the test-statistic.
The model includes terms to account for linear trends and day-of-week effects.
Note that this implementation does NOT account for federal holidays as in the
Regression 1.2 algorithm in ESSENCE. An alert (red value) is signaled if
the statistical test (student”s t-test) applied to the test statistic yields
a p-value less than 0.01. If the p-value is greater than or equal to 0.01
and strictly less than 0.05, a warning (yellow value) is signaled.
Blue values are returned if an alert or warning does not occur.
Grey values represent instances where anomaly detection did not apply
(i.e., observations for which baseline data were unavailable).</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame containing time series data</p></li>
<li><p><strong>t</strong> – The name of the column in df that contains the dates or times of
observations. Defaults to “date”.</p></li>
<li><p><strong>y</strong> – The name of the column in df that contains the values of the
time series. Defaults to “count”.</p></li>
<li><p><strong>B</strong> – The length of the baseline period (in days). Must be a multiple
of 7 and at least 7. Defaults to 28.</p></li>
<li><p><strong>g</strong> – The length of the guard band (in days). Must be non-negative.
Defaults to 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Original pandas data frame with detection results.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp.detectors.regression</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>   <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-12-31&quot;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">366</span><span class="p">)</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_regression</span> <span class="o">=</span> <span class="n">alert_regression</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_regression</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pynssp.detectors.serfling">
<span id="pynssp-detectors-serfling-module"></span><h2>pynssp.detectors.serfling module<a class="headerlink" href="#module-pynssp.detectors.serfling" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.serfling.alert_serfling">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.serfling.</span></span><span class="sig-name descname"><span class="pre">alert_serfling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/serfling.html#alert_serfling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.serfling.alert_serfling" title="Permalink to this definition"></a></dt>
<dd><p>Original Serfling method for weekly time series</p>
<p>The original Serfling algorithm fits a linear regression model with
a time term and order 1 Fourier terms to a baseline period that ideally spans
5 or more years. Inclusion of Fourier terms in the model is intended to
account for seasonality common in multi-year weekly time series. Order 1 sine
and cosine terms are included to account for annual seasonality that is
common to syndromes and diseases such as influenza, RSV, and norovirus. Each
baseline model is used to make weekly forecasts for all weeks following the
baseline period. One-sided upper 95% prediction interval bounds are computed
for each week in the prediction period. Alarms are signaled for any week
during for which weekly observations fall above the upper bound of the
prediction interval. This implementation follows the approach of the original
Serfling method in which weeks between October of the starting year of a
season and May of the ending year of a season are considered to be in the
epidemic period. Weeks in the epidemic period are removed from the baseline
prior to fitting the regression model.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame containing time series data</p></li>
<li><p><strong>t</strong> – Name of the column of type Date containing the dates (Default value = “date”)</p></li>
<li><p><strong>y</strong> – Name of the column of type Numeric containing counts or percentages (Default value = “count”)</p></li>
<li><p><strong>baseline_end</strong> – date of the end of the baseline/training period (in date or string class)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Original pandas dataframe with model estimates, upper prediction interval bounds,
a binary alarm indicator field, and a binary indicator</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>   <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-01-05&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-02-05&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-01-05&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-02-05&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)),))</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_serfling</span>  <span class="o">=</span> <span class="n">alert_serfling</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">baseline_end</span> <span class="o">=</span> <span class="s2">&quot;2020-03-01&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_serfling</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.serfling.serfling_model">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.serfling.</span></span><span class="sig-name descname"><span class="pre">serfling_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/serfling.html#serfling_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.serfling.serfling_model" title="Permalink to this definition"></a></dt>
<dd><p>Original Serfling method for weekly time series</p>
<p>Serfling model helper function for monitoring weekly time series with seasonality</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A pandas data frame</p></li>
<li><p><strong>t</strong> – Name of the column of type Date containing the dates</p></li>
<li><p><strong>y</strong> – Name of the column of type Numeric containing counts</p></li>
<li><p><strong>baseline_end</strong> – date of the end of the baseline/training period (date or string class)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas data frame.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pynssp.detectors.switch">
<span id="pynssp-detectors-switch-module"></span><h2>pynssp.detectors.switch module<a class="headerlink" href="#module-pynssp.detectors.switch" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pynssp.detectors.switch.alert_switch">
<span class="sig-prename descclassname"><span class="pre">pynssp.detectors.switch.</span></span><span class="sig-name descname"><span class="pre">alert_switch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynssp/detectors/switch.html#alert_switch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pynssp.detectors.switch.alert_switch" title="Permalink to this definition"></a></dt>
<dd><p>Regression/EWMA Switch</p>
<p>The NSSP-ESSENCE Regression/EWMA Switch algorithm generalized the Regression and
EWMA algorithms by applying the most appropriate algorithm for the data in the
baseline. First, multiple adaptive regression is applied where the adjusted R
squared value of the model is examined to see if it meets a threshold of 0.60. If
this threshold is not met, then the model is considered to not explain the data well.
In this case, the algorithm switches to the EWMA algorithm, which is more appropriate
for sparser time series that are common with county level trends. The smoothing
coefficient for the EWMA algorithm is fixed to 0.4.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A dataframe containing the time series data.</p></li>
<li><p><strong>t</strong> – The name of the column in <cite>df</cite> containing the time information.
Defaults to “date”.</p></li>
<li><p><strong>y</strong> – The name of the column in <cite>df</cite> containing the values to be analyzed.
Defaults to “count”.</p></li>
<li><p><strong>B</strong> – The length of the baseline period in days, must be a multiple of 7 and
greater than or equal to 7. Defaults to 28.</p></li>
<li><p><strong>g</strong> – The length of the guardband period in days. Must be non-negative.
Defaults to 2.</p></li>
<li><p><strong>w1</strong> – Smoothing coefficient for sensitivity to gradual events. Must be between
0 and 1 and is recommended to be between 0.3 and 0.5 to account for gradual
effects. Defaults to 0.4 to match NSSP-ESSENCE implementation.</p></li>
<li><p><strong>w2</strong> – Smoothed coefficient for sensitivity to sudden events. Must be between
0 and 1 and is recommended to be above 0.7 to account for sudden events.
Defaults to 0.9 to match NSSP-ESSENCE implementation and approximate the C2 algorithm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe containing the results of the analysis.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pynssp.detectors.switch</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>   <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-12-31&quot;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">366</span><span class="p">)</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_switch</span> <span class="o">=</span> <span class="n">alert_switch</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_switch</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pynssp.detectors.trend">
<span id="pynssp-detectors-trend-module"></span><h2>pynssp.detectors.trend module<a class="headerlink" href="#module-pynssp.detectors.trend" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pynssp.detectors">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pynssp.detectors" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pynssp.core.html" class="btn btn-neutral float-left" title="pynssp.core package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="history.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Gbedegnon Roseric Azondekon.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5FTLT9PCW7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-5FTLT9PCW7', {
          'anonymize_ip': false,
      });
    </script>
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Read the Docs</span>
        v: latest
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Versions</dt>
            <dd><a href="#">latest</a></dd>
            <dd><a href="#">0.1.0</a></dd>
            <!-- <dd><a href="#">1.1</a></dd> -->
        </dl>
        <dl>
          <dt>Downloads</dt>
          <dd><a href="https://raw.githubusercontent.com/cdcgov/pynssp/master/docs/pynssp.pdf">PDF</a></dd>
          <!-- <dd><a href="#">ePub</a></dd> -->
          <!-- <dd><a href="#">HTML</a></dd> -->
        </dl>
        <dl>
          <dt>On this Documentation</dt>
            <dd>
              <a href="https://github.com/CDCgov/pynssp/tree/master/docs">doc source</a>
            </dd>
            <dd>
              <a href="https://github.com/CDCgov/pynssp/tree/gh-pages">build source</a>
            </dd>
        </dl>
        <!-- <dl>
          <dt>Debug</dt>
          <dd><a href="#" data-toggle="rst-debug-badge">Swap badge position</a></dd>
        </dl> -->
      </div>
    </div>

</body>
</html>